<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Sat Oct 21 2023 12:42:03 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="63614076e9e25dee468c59ed" data-wf-site="62fa1b7c943e1b195a14776d">
<head>
  <meta charset="utf-8">
  <title>Usage</title>
  <meta content="Usage" property="og:title">
  <meta content="Usage" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/katydid-3d74ff.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["IBM Plex Mono:100,200,300,regular,500,600,700","Noto Sans:200,300,regular,500,600,700,800"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.png" rel="apple-touch-icon">
  <style>
/*width*/
.scroll::-webkit-scrollbar {
width:10px;
}
/*thumb*/
.scroll::-webkit-scrollbar-thumb {
background:rgb(206, 236, 236);
border-radius:0px;
}
/*thumb pressed*/
.scroll::-webkit-scrollbar-thumb:active {
border-radius:2px;
}
</style>
</head>
<body>
  <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-2 dropdowns small-screens w-nav">
    <div class="navbar_container nav_container">
      <a href="../index.html" class="brand w-nav-brand"><img src="../images/katydid-logo-quality.png" loading="lazy" alt="" width="51.5" class="nav_logo"></a>
      <a href="../index.html" class="logo-text w-inline-block">
        <h2 class="heading-6 logo">katydid</h2>
      </a>
      <nav role="navigation" class="nav-menu tablet w-nav-menu">
        <div data-hover="false" data-delay="0" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Parsers</div>
          </div>
          <nav class="dropdown-list dropdown-box w-dropdown-list">
            <a href="../parsers/usage.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Usage</a>
            <a href="../parsers/extend.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Extend</a>
          </nav>
        </div>
        <div data-hover="false" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Language</div>
          </div>
          <nav class="dropdown-list-8 w-dropdown-list">
            <a href="../relapse/usage.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Usage</a>
            <a href="../relapse/syntax.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Syntax</a>
            <a href="../relapse/types.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Types</a>
            <a href="../relapse/functions.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Functions</a>
            <a href="../relapse/extend.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Extend</a>
            <a href="../relapse/speed.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Speed</a>
          </nav>
        </div>
        <div data-hover="false" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Encoders</div>
          </div>
          <nav class="dropdown-list-7 w-dropdown-list">
            <a href="../encoders/usage.html" target="_blank" aria-current="page" class="dropdown-link-3 w-dropdown-link w--current">Usage</a>
          </nav>
        </div>
        <div data-hover="false" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Tests</div>
          </div>
          <nav class="dropdown-list-5 w-dropdown-list">
            <a href="../tests/test-suite.html" target="_blank" class="dropdown-link-3 w-dropdown-link">Test Suite</a>
          </nav>
        </div>
        <a href="https://katydid.github.io/play/" target="_blank" class="nav-button-gradient w-inline-block">
          <div class="nav_button-2 tablet">Playground</div>
        </a>
        <a href="https://katydid.github.io/tour/" target="_blank" class="nav-button-gradient guided w-inline-block">
          <div class="nav_button-2 tablet">Guided Tour</div>
        </a>
      </nav>
      <div class="menu-button-2 tablet w-nav-button">
        <div class="w-icon-nav-menu"></div>
      </div>
    </div>
  </div>
  <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-2 dropdowns desktop w-nav">
    <div class="navbar_container nav_container">
      <a href="../index.html" class="brand w-nav-brand"><img src="../images/katydid-logo-quality.png" loading="lazy" alt="" width="51.5" class="nav_logo"></a>
      <a href="../index.html" class="logo-text w-inline-block">
        <h2 class="heading-6 logo">katydid</h2>
      </a>
      <nav role="navigation" class="nav-menu tablet w-nav-menu">
        <div data-hover="true" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Parsers</div>
          </div>
          <nav class="dropdown-list dropdown-box w-dropdown-list">
            <a href="../parsers/usage.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Usage</a>
            <a href="../parsers/extend.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Extend</a>
          </nav>
        </div>
        <div data-hover="true" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Language</div>
          </div>
          <nav class="dropdown-list-11 w-dropdown-list">
            <a href="../relapse/usage.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Usage</a>
            <a href="../relapse/syntax.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Syntax</a>
            <a href="../relapse/types.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Types</a>
            <a href="../relapse/functions.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Functions</a>
            <a href="../relapse/extend.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Extend</a>
            <a href="../relapse/speed.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Speed</a>
          </nav>
        </div>
        <div data-hover="true" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Encoders</div>
          </div>
          <nav class="dropdown-list-10 w-dropdown-list">
            <a href="../encoders/usage.html" target="_blank" aria-current="page" class="dropdown-link-4 w-dropdown-link w--current">Usage</a>
          </nav>
        </div>
        <div data-hover="true" data-delay="5" class="dropdown w-dropdown">
          <div class="dropdown-toggle-2 links w-dropdown-toggle">
            <div class="text-block-10">Tests</div>
          </div>
          <nav class="dropdown-list-10 w-dropdown-list">
            <a href="../tests/test-suite.html" target="_blank" class="dropdown-link-4 w-dropdown-link">Test Suite</a>
          </nav>
        </div>
        <a href="https://katydid.github.io/play/" target="_blank" class="nav-button-gradient w-inline-block">
          <div class="nav_button-2 tablet">Playground</div>
        </a>
        <a href="https://katydid.github.io/tour/" target="_blank" class="nav-button-gradient guided w-inline-block">
          <div class="nav_button-2 tablet">Guided Tour</div>
        </a>
      </nav>
      <div class="menu-button-2 tablet w-nav-button">
        <div class="w-icon-nav-menu"></div>
      </div>
    </div>
  </div>
  <div class="hero-section">
    <div data-w-id="d3b4d7b0-9c8f-d638-412f-9cdf5fa0ce1b" style="opacity:0" class="circle_heading">
      <div class="hero-heading usage">Usage</div>
    </div>
    <div class="intro">
      <p class="paragraph first">This page will explain how to encode a parser.</p>
      <p class="paragraph heading">Currently katydid supports several encoders:<br></p>
      <div class="intro-ticks">
        <div class="div-block-2"><img src="../images/tick.svg" loading="lazy" alt="" class="parsers_tick"><img src="../images/tick.svg" loading="lazy" alt="" class="parsers_tick"><img src="../images/tick.svg" loading="lazy" alt="" class="parsers_tick"><img src="../images/tick.svg" loading="lazy" alt="" class="parsers_tick"></div>
        <p class="paragraph-6">protobuf<br>json      <br>reflected go structures<br>xml</p>
      </div>
    </div>
  </div>
  <div class="section-margin">
    <div class="my-container">
      <p class="paragraph">This assumes you have already constructed a parser, if not see the page on <a href="../parsers/usage.html" class="inline-link">parser usage</a>.</p>
    </div>
    <div class="my-container heading">
      <div class="w-embed">
        <style>
.gradient {
    -webkit-text-fill-color: transparent;
    -webkit-background-clip: text;
</style>
      </div>
      <h1 class="gradient-heading gradient heading-size-18">Using an Encoder</h1>
      <p class="paragraph">Encoding json and xml is quite easy.</p>
    </div>
    <div class="code-block">
      <div class="code-block-text"><span class="res-words">import</span> <span class="strings">&quot;github.com/katydid/katydid/parser&quot; </span><br><span class="res-words">import</span> <span class="strings">&quot;github.com/katydid/katydid/encode/json&quot;</span> <br><span class="res-words">import</span> <span class="strings">&quot;github.com/katydid/katydid/encode/xml&quot;</span> <br><br><span class="res-words">func</span> encodeToJson(p parser.Interface) ([]<span class="res-words">byte</span>, <span class="res-words">error</span>) { <br>    <span class="res-words">return</span> json.Encode(p) <br>} <br><br><span class="res-words">func</span> encodeToXml(p parser.Interface) ([]<span class="res-words">byte</span>, <span class="res-words">error</span>) { <br>    <span class="res-words">return</span> xml.Encode(p) <br>}<br></div>
    </div>
    <div class="my-container">
      <p class="paragraph">Encoding a reflect Go structure requires also passing the structure into which will be encoded, or rather unmarshaled.</p>
    </div>
    <div class="code-block">
      <div class="code-block-text"><span class="res-words">import</span> <span class="strings">&quot;github.com/katydid/katydid/parser&quot;</span> <br><span class="res-words">import</span> reflectencoder <span class="strings">&quot;github.com/katydid/katydid/encode/reflect&quot;</span> <br><span class="res-words">import</span> <span class="strings">&quot;reflect&quot;</span> <br><br><span class="res-words">func</span> unmarshal(p parser.Interface, a *A) <span class="res-words">error</span> { <br>    v := reflect.ValueOf(a) <br>    <span class="res-words">return</span> reflectencoder.Encode(p, v) <br>}<br></div>
    </div>
    <div class="my-container">
      <p class="paragraph">Finally encoding into a protocol buffer (marshaling/dynamic transcoding) is a little bit more involved.</p>
    </div>
    <div class="code-block">
      <div class="code-block-text"><span class="res-words">import</span> <span class="strings">&quot;github.com/katydid/katydid/parser&quot;</span> <br><span class="res-words">import</span> <span class="strings">&quot;github.com/gogo/protobuf/protoc-gen-gogo/descriptor&quot;</span> <br><span class="res-words">import</span> <span class="strings">&quot;github.com/katydid/katydid/encode/proto&quot;</span> <br><br><span class="res-words">func</span> encodeToProto(p parser.Interafce, fileDescriptorSet*descriptor.FileDescriptorSet, packageName, messageName <span class="res-words">string</span>) ([]<span class="res-words">byte</span>, <span class="res-words">error</span>){ <br>    enc, err := proto.NewEncoder(fileDescriptorSet, packageName, messageName) <br>    <span class="res-words">if</span> err != <span class="res-id">nil</span> { <br>        <span class="res-words">return</span> <span class="res-id">nil</span>, err <br>     } <br>    <span class="res-words">return</span> enc.Encode(<span class="res-id">make</span>([]byte, <span class="int">1024</span>*<span class="int">1024</span>), p) <br>}<br></div>
    </div>
    <div class="my-container last">
      <p class="paragraph">Dynamic encoding means that the protocol buffer does not necessarily need to be compiled in the program. Parsing the <span class="inline-code">.proto</span> files with protoc can give you a <span class="inline-code">fileDescriptorSet</span> which specifies the protocol buffer message. The <span class="inline-code">packageName</span> and <span class="inline-code">messageName</span> are used to locate the message in the <span class="inline-code">fileDescriptorSet</span>. The <span class="inline-code">fileDescriptorSet</span> can also be generated by gogoprotobuf as a method on the message.<br><br>The encoder can be reused and providing a large enough buffer to encode means that the buffer can also be reused.</p>
    </div>
  </div>
  <div class="footer-section">
    <div class="footer-div">
      <div class="w-layout-grid footer-grid">
        <div class="footer-col">
          <div class="image-div"><img src="../images/katydid-logo-quality.png" loading="lazy" width="51.5" alt="" class="image-31"></div>
          <div class="text-block-21">katydid</div>
        </div>
        <div id="w-node-abfc4d3e-97fb-1ab1-409a-ead63d40dead-3d40dea5" class="footer-col">
          <h1 class="grid-head">About</h1>
          <div class="grid-text">
            <a href="https://github.com/katydid" target="_blank" class="footer-link">Project</a>
          </div>
          <div class="grid-text">
            <a href="http://katydid.github.io/play" target="_blank" class="footer-link">Playground</a>
          </div>
        </div>
        <div id="w-node-abfc4d3e-97fb-1ab1-409a-ead63d40deb4-3d40dea5" class="footer-col">
          <h1 class="grid-head">Contribute</h1>
          <div class="grid-text">
            <a href="mailto:awalterschulze@gmail.com" class="footer-link">Contact</a>
          </div>
          <div class="grid-text">
            <a href="http://github.com/katydid" target="_blank" class="footer-link">Github</a>
          </div>
          <div class="grid-text">
            <a href="#" target="_blank" class="footer-link">More</a>
          </div>
        </div>
        <div id="w-node-abfc4d3e-97fb-1ab1-409a-ead63d40debd-3d40dea5" class="footer-col">
          <h1 class="grid-head">Implement</h1>
          <div class="grid-text">
            <a href="http://github.com/katydid/katydid" target="_blank" class="footer-link">Go</a>
          </div>
          <div class="grid-text">
            <a href="https://github.com/katydid/katydid-haskell" target="_blank" class="footer-link">Haskell</a>
          </div>
          <div class="grid-text">
            <a href="http://github.com/katydid/proofs" target="_blank" class="footer-link">Lean</a>
          </div>
        </div>
        <div id="w-node-abfc4d3e-97fb-1ab1-409a-ead63d40dec6-3d40dea5" class="footer-col">
          <h1 class="grid-head">Social</h1>
          <div class="grid-text">
            <a href="https://github.com/awalterschulze" target="_blank" class="footer-link">Github</a>
          </div>
          <div class="grid-text">
            <a href="https://www.linkedin.com/in/awalterschulze/" target="_blank" class="footer-link">LinkedIn</a>
          </div>
          <div class="grid-text">
            <a href="https://twitter.com/awalterschulze" target="_blank" class="footer-link">Twitter</a>
          </div>
          <div class="grid-text">
            <a href="https://www.youtube.com/c/awalterschulze" target="_blank" class="footer-link">Youtube</a>
          </div>
        </div>
        <div id="w-node-abfc4d3e-97fb-1ab1-409a-ead63d40ded1-3d40dea5" class="footer-col">
          <h1 class="grid-head">Help</h1>
          <div class="grid-text">
            <a href="http://katydid.github.io/tour" target="_blank" class="footer-link">Tour</a>
          </div>
          <div class="grid-text">
            <a href="http://github.com/katydid/katydid/issues" target="_blank" class="footer-link">Issues</a>
          </div>
          <div class="grid-text">
            <a href="../relapse/syntax.html" target="_blank" class="footer-link">Syntax</a>
          </div>
        </div>
      </div>
      <div class="text-block-3">© Copyright 2014 - 2022 Walter Schulze</div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=62fa1b7c943e1b195a14776d" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
</body>
</html>